# ╔══════════════════════════════════════════════════════════════╗
# ║  LogSentinel AI — Docker Environment Configuration          ║
# ║                                                            ║
# ║  Copy this file to .env and edit the values below.         ║
# ║  Required: DB_HOST and DB_PASSWORD.                        ║
# ║  For --profile collector: also INGEST_API_KEY.             ║
# ║  AI model & API key are configured via the UI.             ║
# ╚══════════════════════════════════════════════════════════════╝

# ── Database ─────────────────────────────────────────────────
#
# OPTION A — External PostgreSQL (you manage your own server):
#   Set DB_HOST to your PostgreSQL server IP/hostname.
#   Run:  docker compose up -d
#
# OPTION B — Bundled PostgreSQL (all-in-one, no external DB needed):
#   Set DB_HOST=postgres  (the container hostname)
#   Run:  docker compose --profile db up -d
#
DB_HOST=localhost
DB_NAME=logsentinel_ai
DB_USER=syslog_ai
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DB_PORT=5432

# Expose bundled PostgreSQL to host? (only relevant with --profile db)
# Set to 0.0.0.0:5432 to allow external access.
# DB_EXTERNAL_PORT=127.0.0.1:5432

# ── LLM (AI Analysis) ───────────────────────────────────────
# Optional here — API key and model are configurable via the UI
# (Settings > AI Model). Environment variables serve as initial
# fallback only. You can set the key here OR in the UI — either works.
# OPENAI_API_KEY=sk-your-openai-key-here

# ── Dashboard URL ────────────────────────────────────────────
# VITE_API_URL is baked into the dashboard at build time.
# Set this to the backend URL as reachable from the user's browser.
#
# For local use:  http://localhost:3000
# For LAN/remote: http://<your-server-ip>:3000
VITE_API_URL=http://localhost:3000
DASHBOARD_PORT=8070

# ── CORS ─────────────────────────────────────────────────────
# Set to the dashboard URL to restrict cross-origin requests.
# For local use:  http://localhost:8070
# For LAN/remote: http://<your-server-ip>:8070
CORS_ORIGIN=http://localhost:8070

# ── Backend Port ─────────────────────────────────────────────
PORT=3000

# ── Admin Account (optional) ────────────────────────────────
# On first start, if no users exist, an admin account is created.
# If these are not set, a random password is generated and printed to logs.
# ADMIN_USERNAME=admin
# ADMIN_PASSWORD=YourSecureAdminPassword123!

# ── Pipeline ─────────────────────────────────────────────────
# AI pipeline interval in milliseconds (default: 5 minutes)
PIPELINE_INTERVAL_MS=300000

# ── Security / Redaction ─────────────────────────────────────
REDACTION_ENABLED=false

# ── Timezone ─────────────────────────────────────────────────
TZ=Europe/Chisinau

# ── Log Collector (Fluent Bit — optional, --profile collector) ──
# Enable with: docker compose --profile collector up -d
#
# The collector runs with network_mode: host so it sees the real
# source IP addresses of syslog senders (Docker NATs UDP otherwise).
#
# INGEST_API_KEY is REQUIRED if using the collector.
# Create an API key in Settings > API Keys with "ingest" scope,
# then paste it here.
# INGEST_API_KEY=your-ingest-api-key-here
#
# Backend connection — with network_mode: host, Docker DNS is
# unavailable so use 127.0.0.1 (same host) or an IP address.
# INGEST_HOST=127.0.0.1
#
# Syslog ports — RFC 3164 (legacy/BSD, used by most devices)
SYSLOG_UDP_PORT=5140
SYSLOG_TCP_PORT=5140
#
# Syslog port — RFC 5424 (modern format, TCP only)
# SYSLOG_RFC5424_PORT=5141
#
# OpenTelemetry OTLP port (accepts both HTTP and gRPC)
OTEL_PORT=4318
#
# Docker data root — only needed if Docker stores data outside /var/lib/docker.
# Find yours with:  docker info | grep "Docker Root Dir"
# DOCKER_DATA_ROOT=/var/lib/docker
#
# Fluent Bit log level (error, warn, info, debug, trace)
# COLLECTOR_LOG_LEVEL=info

# ── Dashboard URL (for notification deep-links) ──────────────
# Set to the external URL of the dashboard so alert notifications
# can include a direct link to the affected system.
# DASHBOARD_URL=http://localhost:8070

# ── Alerting Tokens (optional) ───────────────────────────────
# PUSHOVER_TOKEN=
# PUSHOVER_USER_KEY=
# NTFY_BASE_URL=https://ntfy.sh
# NTFY_TOPIC=
# GOTIFY_BASE_URL=
# GOTIFY_APP_TOKEN=
# TELEGRAM_BOT_TOKEN=
# TELEGRAM_CHAT_ID=
